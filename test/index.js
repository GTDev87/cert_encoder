'use strict';
var assert = require('assert');
var certEncoding = require('../lib');

describe('cert-encoding', function () {
  it('test certificate conversion', function () {
    var actualPemCertificate = 
      "-----BEGIN CERTIFICATE-----\n" +
      "MIICpDCCAYwCCQDPSndIutt5pDANBgkqhkiG9w0BAQsFADAUMRIwEAYDVQQDEwls\n" +
      "b2NhbGhvc3QwHhcNMTUwNzI5MjIyNzAwWhcNMTUwNzMwMjIyNzAwWjAUMRIwEAYD\n" +
      "VQQDEwlsb2NhbGhvc3QwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDD\n" +
      "oi6MWli19jXtAzPPUi+t2JuswXIlENfN9SQcskjTAIobwJ14ABPkmiHGqY9IztC6\n" +
      "XCBeiMCFHmaVDVV/l7/njgFSJXMqHKP9QMVZhJoikhUN9pmpeWt14T0u/IbHXRG0\n" +
      "Jo6CurPuQDFfNZqW+qPnublgM72Kz72ZLbuVtg0MFi3LVg7Icqf/emEQrhjytH0m\n" +
      "wNfnDaJPA4+s04HyREaCqhf6m5H+4AtePUN2nDlbNhyMzNeOBry/EuyF++ZVZKD8\n" +
      "Qlk0VDwBzckktZC/pOEsv/ke6OJOnaAO0efF5hAr/XZ8e+1tIjB5U415ClSZSrK4\n" +
      "xL5/ScoqVB/jYqwBc6D5AgMBAAEwDQYJKoZIhvcNAQELBQADggEBAAJKy++Uc8zY\n" +
      "EOb9WR2QGtBG/o2RckK4X6/yMl2Qb2H+ZZ6sNOOQy9Ej8yyv3KM0GgKf3kwmhJAX\n" +
      "g/QeZapzL8lqzVps+ctDCIwxz2BoYsGgCwIWgKvGqu66p4nQJJ5g7q5w+EW9yfO1\n" +
      "14ECw33zwX2kfL64BpELc6eqwgfNiM5nBz4XPNYx5K583Nt/WV5+Gsm5lXCMKNE+\n" +
      "P7fSDrV+2bgrSwr9FIh2yItqkytA/i6Jvz0QWzy5K0M3JIPa2knMrAPkIl+f85uv\n" +
      "ieiLBIeoFBY8OA/QWB6tCCFcOyknRfBEObRylWO9kfvQjYXpBMTxHFLcq5mf2NYZ\n" +
      "OYi5xJYCr4Y=\n" +
      "-----END CERTIFICATE-----";

    var certificateDEM = new Buffer([
      48, 130, 2, 164, 48, 130, 1, 140, 2, 9, 0, 207, 74, 119, 72, 186, 219, 121, 164, 48, 13, 6, 9, 42, 134, 72, 134, 247, 13, 1, 1, 11, 5, 0, 48, 20, 49, 18, 48, 16, 6, 3, 85, 4, 3, 19, 9, 108, 111, 99, 97, 108, 104, 111, 115, 116, 48, 30, 23, 13, 49, 53, 48, 55,
      50, 57, 50, 50, 50, 55, 48, 48, 90, 23, 13, 49, 53, 48, 55, 51, 48, 50, 50, 50, 55, 48, 48, 90, 48, 20, 49, 18, 48, 16, 6, 3, 85, 4, 3, 19, 9, 108, 111, 99, 97, 108, 104, 111, 115, 116, 48, 130, 1, 34, 48, 13, 6, 9, 42, 134, 72, 134, 247, 13, 1, 1, 1, 5,
      0, 3, 130, 1, 15, 0, 48, 130, 1, 10, 2, 130, 1, 1, 0, 195, 162, 46, 140, 90, 88, 181, 246, 53, 237, 3, 51, 207, 82, 47, 173, 216, 155, 172, 193, 114, 37, 16, 215, 205, 245, 36, 28, 178, 72, 211, 0, 138, 27, 192, 157, 120, 0, 19, 228, 154, 33, 198, 169, 143, 72, 206, 208, 186,
      92, 32, 94, 136, 192, 133, 30, 102, 149, 13, 85, 127, 151, 191, 231, 142, 1, 82, 37, 115, 42, 28, 163, 253, 64, 197, 89, 132, 154, 34, 146, 21, 13, 246, 153, 169, 121, 107, 117, 225, 61, 46, 252, 134, 199, 93, 17, 180, 38, 142, 130, 186, 179, 238, 64, 49, 95, 53, 154, 150, 250, 163, 231, 185,
      185, 96, 51, 189, 138, 207, 189, 153, 45, 187, 149, 182, 13, 12, 22, 45, 203, 86, 14, 200, 114, 167, 255, 122, 97, 16, 174, 24, 242, 180, 125, 38, 192, 215, 231, 13, 162, 79, 3, 143, 172, 211, 129, 242, 68, 70, 130, 170, 23, 250, 155, 145, 254, 224, 11, 94, 61, 67, 118, 156, 57, 91, 54, 28,
      140, 204, 215, 142, 6, 188, 191, 18, 236, 133, 251, 230, 85, 100, 160, 252, 66, 89, 52, 84, 60, 1, 205, 201, 36, 181, 144, 191, 164, 225, 44, 191, 249, 30, 232, 226, 78, 157, 160, 14, 209, 231, 197, 230, 16, 43, 253, 118, 124, 123, 237, 109, 34, 48, 121, 83, 141, 121, 10, 84, 153, 74, 178, 184,
      196, 190, 127, 73, 202, 42, 84, 31, 227, 98, 172, 1, 115, 160, 249, 2, 3, 1, 0, 1, 48, 13, 6, 9, 42, 134, 72, 134, 247, 13, 1, 1, 11, 5, 0, 3, 130, 1, 1, 0, 2, 74, 203, 239, 148, 115, 204, 216, 16, 230, 253, 89, 29, 144, 26, 208, 70, 254, 141, 145, 114, 66, 184, 95,
      175, 242, 50, 93, 144, 111, 97, 254, 101, 158, 172, 52, 227, 144, 203, 209, 35, 243, 44, 175, 220, 163, 52, 26, 2, 159, 222, 76, 38, 132, 144, 23, 131, 244, 30, 101, 170, 115, 47, 201, 106, 205, 90, 108, 249, 203, 67, 8, 140, 49, 207, 96, 104, 98, 193, 160, 11, 2, 22, 128, 171, 198, 170, 238,
      186, 167, 137, 208, 36, 158, 96, 238, 174, 112, 248, 69, 189, 201, 243, 181, 215, 129, 2, 195, 125, 243, 193, 125, 164, 124, 190, 184, 6, 145, 11, 115, 167, 170, 194, 7, 205, 136, 206, 103, 7, 62, 23, 60, 214, 49, 228, 174, 124, 220, 219, 127, 89, 94, 126, 26, 201, 185, 149, 112, 140, 40, 209, 62,
      63, 183, 210, 14, 181, 126, 217, 184, 43, 75, 10, 253, 20, 136, 118, 200, 139, 106, 147, 43, 64, 254, 46, 137, 191, 61, 16, 91, 60, 185, 43, 67, 55, 36, 131, 218, 218, 73, 204, 172, 3, 228, 34, 95, 159, 243, 155, 175, 137, 232, 139, 4, 135, 168, 20, 22, 60, 56, 15, 208, 88, 30, 173, 8,
      33, 92, 59, 41, 39, 69, 240, 68, 57, 180, 114, 149, 99, 189, 145, 251, 208, 141, 133, 233, 4, 196, 241, 28, 82, 220, 171, 153, 159, 216, 214, 25, 57, 136, 185, 196, 150, 2, 175, 134
    ]);
    
    debugger;
    assert(actualPemCertificate, certEncoding.convert(certificateDEM));
  });
});